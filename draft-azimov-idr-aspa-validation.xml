<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC4271 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4271.xml">
<!ENTITY RFC4486 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4486.xml">
<!ENTITY RFC5226 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5226.xml">
<!ENTITY RFC5492 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5492.xml">
]>

<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>

<rfc category="std" docName="draft-azimov-idr-aspa-validation" ipr="trust200902">
 <front>

   <title abbrev="ASPA Validation"> Validation of AS_PATH Using the Resource Certificate Public Key Infrastructure (PKI) and
                   Austonomous System Provider Authorization (ASPAs) </title>

   <author fullname="Alexander Azimov" initials="A"
           surname="Azimov">
     <organization>Qrator Labs</organization>
     <address>
       <email>aa@qrator.net</email>
     </address>
   </author>


   <author fullname="Job Snijders" initials="J"
           surname="Snijders">
     <organization>NTT</organization>
     <address>
       <email>job@ntt.net</email>
     </address>
   </author>

   <date month="March" year="2018"/>

   <keyword>BGP</keyword>
   <keyword>Route leak</keyword>
   <keyword>Hijacks</keyword>

   <abstract>
     <t>
         This document defines the semantics of a Autonomous System Provider Authorzation (ASPA) in terms of the
         context of an application of the Resource Public Key Infrastructure to validate the AS_PATH attribute of
         routes advertised in the Border Gateway Protocol.
     </t>
   </abstract>

   <note title="Requirements Language">
     <t>
       The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
       "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" are to be
       interpreted as described in <xref target="RFC2119">RFC 2119</xref>
       only when they appear in all upper case.  They may also appear in lower
       or mixed case as English words, without normative meaning.
     </t>
   </note>
 </front>

<middle>

    <section title="Introduction" anchor="intro">
        <t>
            The BGP was designed without any mechanisms that can guarantee the validity of BGP attributes. The
            outcome of this limitations are BGP Hijacks and BGP Route Leaks [#link]. Extensions to BGP are able to
            partially solve these problems. For example RPKI can be used to detect and filter leaked static routes,
            and [link to open policy/eOTC] can be used to detect mistake route leaks type XXX. While these upgrades are
            quite useful, they still rely on BGP attributes, especially AS_PATH, that can be also violated by attackers.
        </t>
        <t>
            It is believed that BGPSec [#link] can solve problem of AS_PATH validation. But even ignoring
            overcomplexity of this BGP extension, it has backward support for 'old' BGP that nullifies all work with
            signatures. As a result, to keep violating AS_PATH or any other transit attribute, an attacker just need to
            use 'old' BGP.
        </t>
        <t>
            This document defines the semantics of a Autonomous System Provider Authorization (ASPA) in terms of the
            context of an application of the Resource Public Key Infrastructure to validate the AS_PATH attribute of
            routes advertised in the Border Gateway Protocol. This documents specifies AS_PATH validation procedure
            which allows to detect and mitigate malicious hijacks and route leaks.
        </t>

    </section>

    <section title="Autonomous System Provider Authorization" anchor="ASPA">
        <t>
           The RPKI is based on a hierarchy of resource certificates that are aligned to the Internet Number
           Resource allocation structure. Resource certificates are X.509 certificates that conform to the PKIX
           profile [RFC5280], and to the extensions for IP addresses and AS identifiers [RFC3779]. A resource
           certificate describes an action by an issuer that binds a list of IP address blocks and Autonomous System
           (AS) numbers to the subject of a certificate, identified by the unique association of the subject's
           private key with the public key contained in the resource certificate.  The RPKI is structured such that
           each current resource certificate matches a current resource allocation or assignment.  This is further
           described in [RFC6480].
        </t>

        <t>
           ASPAs are digitally signed objects that bind a provider AS number to a customer AS number, and are signed by
           the holder of customer AS. ASPA provides a means of verifying that an AS holder has authorized a
           particular provider AS to send routes in all directions, including upper upstream providers or peers.
           ASPAs are described in [#link]. ASPAs are intended to fit within the requirements for adding security to
           inter-domain routing and give an opportunity to detect and filter malicious hijacks and route leaks.
        </t>

    </section>
    
    <section title="Malicious Hijacks and Route Lekas" anchor="malicious">
        #DESCRIPTION
    </section>

    <section title="ASN Pair Validation Procedure" anchor="pair-validation">
        <t>
            It is assumed here that a relying party (RP) has access to a local cache of the complete set of valid
            ASPAs when performing validation of a AS_PATH.  The RP needs to match a AS_PATH to one or more valid ASPAs
            in order to determine a validation outcome, which, in turn, can be used to determine the appropriate
            local actions to perform on the route.
        </t>


        <t> For a pair (ASN1, ASN2) validity state is defined by the following procedure:
            <list style="numbers">
                <t>
                    Select all valid ASPAs with customer value equal to ASN2. This selection forms the set of "candidate
                    ASPAs".
                </t>
                <t>
                    If the set of candidate ASPAs is empty, then the procedure stops with an outcome of "unknown"
                    (or, synonymously, "not found", as used in [BGP-PFX]).
                </t>
                <t>
                    If there is ASPAs in the list of candidate ASPAs where provider field equals to ASN1, then the
                    procedure halts with an outcome of "valid".
                </t>
                <t>
                    Otherwise, the procedure halts with an outcome of "invalid".
                </t>
            </list>
            
        </t>
    </section>
    
    <section title="AS_PATH Validation">
        <t>
            AS_PATH attribute identifies the autonomous systems through which routing information carried in this
            UPDATE message has passed.  The components of this list can be AS_SETs or AS_SEQ, as defined in
            [RFC4271]. When route is received from customer or literal peer it SHOULD have in its AS_SEQ
            components only customer-provider pairs. If it has other types of pairs, it does mean that this route was
            leaked or AS_PATH attribute was malformed. In this case such route must be dropped. It's also important
            to highlight that routes that have AS_SET components in AS_PATH can't be fully validated and should be
            treated with caution.
        </t>

        <t> If route is received from customer or peer it MUST validate AS_PATH attribute using following criteria:
            <list style="numbers">
                <t>
                    If AS_PATH has invalid pair of ASNs, such route MUST be dropped;
                </t>
                <t>
                    If AS_PATH have at least one AS_SET component, set LOCAL_PREF to pref_set;
                </t>
                <t>
                    If AS_PATH doesn't have AS_SET components in AS_PATH but have at least one unknown pair of ASNs
                    set LOCAL_REF to pref_unknown;
                </t>
                <t>
                    Otherwise - set LOCAL_PREF to pref_valid.
                </t>
            </list>
            These values MUST have next order: pref_set &lt; pref_unknown &lt;= pref_valid.
        </t>
    </section>




   <section anchor="IANA" title="IANA Considerations">
   </section>

   <section anchor="Security" title="Security Considerations">
   </section>

   <section anchor="Acknowledgments" title="Acknowledgments">
    </section>

</middle>

 <back>
   <references title="Normative References">
     &RFC2119;
     &RFC4271;
     &RFC4486;
     &RFC5492;
   </references>

   <references title="Informative References">
     &RFC5226;
  </references>
 </back>
</rfc>


