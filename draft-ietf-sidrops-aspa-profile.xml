<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>

<rfc xmlns:xi="http://www.w3.org/2001/XInclude"
     category="std"
     docName="draft-ietf-sidrops-aspa-profile-13"
     ipr="trust200902"
     consensus="true"
     submissionType="IETF">

  <front>
    <title abbrev="RPKI ASPA Profile">
      A Profile for Autonomous System Provider Authorization
    </title>

    <author fullname="Alexander Azimov" initials="A" surname="Azimov">
      <organization>Yandex</organization>
      <address>
        <email>a.e.azimov@gmail.com</email>
      </address>
    </author>
    <author fullname="Eugene Uskov" initials="E" surname="Uskov">
      <organization>JetLend</organization>
      <address>
        <email>eu@jetlend.ru</email>
      </address>
    </author>
    <author fullname="Randy Bush" initials="R" surname="Bush">
      <organization>Internet Initiative Japan</organization>
      <address>
        <email>randy@psg.com</email>
      </address>
    </author>
    <author fullname="Job Snijders" initials="J." surname="Snijders">
      <organization>Fastly</organization>
      <address>
        <postal>
          <street/>
          <city>Amsterdam</city>
          <code/>
          <country>NL</country>
        </postal>
        <email>job@fastly.com</email>
      </address>
    </author>
    <author fullname="Russ Housley" initials="R" surname="Housley">
      <organization abbrev="Vigil Security">Vigil Security, LLC</organization>
      <address>
        <postal>
          <street>918 Spring Knoll Drive</street>
          <city>Herndon</city>
          <region>VA</region>
          <code>20170</code>
          <country>USA</country>
        </postal>
        <email>housley@vigilsec.com</email>
      </address>
    </author>
    <author fullname="Ben Maddison" initials="B" surname="Maddison">
      <organization abbrev="Workonline">Workonline</organization>
      <address>
        <postal>
          <street/>
          <city>Cape Town</city>
          <country>South Africa</country>
        </postal>
        <email>benm@workonline.africa</email>
      </address>
    </author>
    <date/>
    <keyword>BGP</keyword>
    <keyword>Route leak</keyword>
    <keyword>Hijacks</keyword>
    <abstract>
      <t>
        This document defines a Cryptographic Message Syntax (CMS) protected content type for Autonomous System Provider Authorization (ASPA) objects for use with the Resource Public Key Infrastructure (RPKI).
        An ASPA is a digitally signed object through which the issuer (the holder of an Autonomous System identifier), can authorize one or more other Autonomous Systems (ASes) as its upstream providers.
        When validated, an ASPA's eContent can be used for detection and mitigation of route leaks.
      </t>
    </abstract>

    <note title="Requirements Language">
      <t>
                The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
                "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
                "OPTIONAL" in this document are to be interpreted as described in
                BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and
                only when, they appear in all capitals, as shown here.
      </t>
    </note>

  </front>

  <middle>
    <section title="Introduction" anchor="intro">
      <t>
        The primary purpose of the Resource Public Key Infrastructure (RPKI) is to improve routing security <xref target="RFC6480"/>.
        As part of this infrastructure, a mechanism is needed to facilitate holders of Autonomous System (AS) identifiers in their capacity as Customer to authorize other ASes as their Provider(s).
        A Provider AS (PAS) is a network that:
        <list style="letters">
          <t>offers its customers outbound (customer to Internet) data traffic connectivity and/or</t>
          <t>further propagates in all directions (towards providers, lateral peers, and customers) any BGP Updates that the customer may send.</t>
        </list>
        The digitally signed Autonomous System Provider Authorization (ASPA) object described in this document provides the above-mentioned authorization mechanism.
      </t>
      <t>
        An ASPA object is a cryptographically verifiable attestation signed by the holder of an Autonomous System identifier (hereafter called the "Customer AS", or CAS).
        An ASPA contains a list of one or more ASes, each listing meaning the listed AS is authorized to act as Provider network.
        When the CAS has multiple Providers, all Provider ASes are listed in the ASPA, including any non-transparent Internet Exchange Point (IXP) Route Server (RS) ASes.
        The common case for RS ASes at IXPs is to operate transparently (see Section 2.2.2.1 <xref target="RFC7947"/>), and in those instances the ASNs of IXP Route Servers are not listed as PAS in ASPAs.
	  </t>
      <t>
        The BGP Roles that an Autonomous System (AS) may have in its peering relationships with eBGP neighbors are discussed in <xref target="I-D.ietf-sidrops-aspa-verification"/>.
        The details of ASPA registration requirements for ASes in different scenarios are also specified in that document.
        In addition, the procedures for verifying AS_PATHs in BGP UPDATE messages using Validated ASPA Payloads (VAPs) are described in that document.
      </t>
      <t>
        This CMS <xref target="RFC5652"/> protected content type definition conforms to the <xref target="RFC6488"/> template for RPKI signed objects.
        In accordance with Section 4 of <xref target="RFC6488"/>, this document defines:
        <list style="numbers">
          <t>
            The object identifier (OID) that identifies the ASPA signed object.
            This OID appears in the eContentType field of the encapContentInfo object as well as the content-type signed attribute within the signerInfo structure.
          </t>
          <t>
            The ASN.1 syntax for the ASPA content, which is the payload signed by the CAS.
            The ASPA content is encoded using the ASN.1 <xref target="X.680"/> Distinguished Encoding Rules (DER) <xref target="X.690"/>.
          </t>
          <t>
            The steps required to validate an ASPA beyond the validation steps specified in <xref target="RFC6488"/>.
          </t>
        </list>
      </t>
    </section>

    <section title="ASPA Content Type" anchor="content-type">
      <t>
        The content-type for an ASPA is defined as id-ct-ASPA, which has the numerical value of 1.2.840.113549.1.9.16.1.49.
        This OID MUST appear both within the eContentType in the encapContentInfo structure as well as the content-type signed attribute within the signerInfo structure (see <xref target="RFC6488"/>).
      </t>
    </section>

    <section title="ASPA eContent" anchor="content">
      <t>
        The content of an ASPA identifies the Customer AS (CAS) as well as the Set of Provider ASes (SPAS) that are authorized by the CAS to be its Providers.
      </t>
      <t>
        A user registering ASPA(s) must be cognizant of Sections 2, 3, and 4 of <xref target="I-D.ietf-sidrops-aspa-verification"/> and the user (or their software tool) must comply with the ASPA registration recommendations in Section 4 of that document.
      </t>
      <t>
        It is highly recommended that for a given Customer AS, a single ASPA object be maintained which contains all providers, including any non-transparent RS ASes.
        Such a practice helps prevent race conditions during ASPA updates.
        Otherwise, said race conditions might affect route propagation.
        The software that provides hosting for ASPA records SHOULD support enforcement of this recommendation.
        In the case of the transition process between different CA registries, the ASPA records SHOULD be kept identical in all registries in terms of their authorization contents.
      </t>
      <t>
        The eContent of an ASPA is an instance of ASProviderAttestation, formally defined by the following ASN.1 <xref target="X.680"/> module:
      </t>

      <sourcecode type="asn.1" src="RPKI-ASPA-2022.asn"/>

      <t>
        Note that this content appears as the eContent within the encapContentInfo as specified in <xref target="RFC6488"/>.
      </t>

      <section title="version">
        <t>
          The version number of the ASProviderAttestation MUST be v0.
        </t>
      </section>

      <section title="customerASID">
        <t>
          The customerASID field contains the AS number of the Customer Autonomous System that is the authorizing entity.
        </t>
      </section>

      <section title="providers">
        <t>
          The providers field contains the listing of ASes that are authorized as providers.
        </t>
        <t>
          Each element contained in the providers field is an instance of ProviderAS.
        </t>
        <t>
          In addition to the constraints described by the formal ASN.1 definition, the contents of the providers field MUST satisfy the following constraints:
        <list style="symbols">
          <t>
            The CustomerASID value MUST NOT appear in any providerASID field.
          </t>
          <t>
            The elements of providers MUST be ordered in ascending numerical order by the value of the providerASID field.
          </t>
          <t>
            Each value of providerASID MUST be unique (with respect to the other elements of providers).
          </t>
          </list>
        </t>

        <section title="ProviderAS">
          <section title="providerASID">
            <t>
              The providerASID field contains the AS number of an AS that has been authorized by the customer AS as its provider or RS in the specified address family.
            </t>
          </section>
          <section title="afiLimit">
            <t>
              The afiLimit field optionally constrains the authorization given to the provider AS to a single address family.
            </t>
            <t>
              If present, it contains the two-octet Address Family Identifier (AFI) for which the relation between the customer and provider is authorized.
              This specification only supports IPv4 and IPv6.
              Therefore, the value MUST be either 0001 or 0002, as specified in the Address Family Numbers registry <xref target="IANA-AF"/> maintained by IANA.
            </t>
            <t>
              If omitted, the authorization is valid for both IPv4 and IPv6 announcements.
            </t>
          </section>
        </section>

      </section>
    </section>

    <section title="ASPA Validation" anchor="validation">
      <t>
        Before a relying party can use an ASPA to validate a routing announcement, the relying party MUST first validate the ASPA object itself.
        To validate an ASPA, the relying party MUST perform all the validation checks specified in <xref target="RFC6488"/> as well as the following additional ASPA-specific validation steps.
        <list style="symbols">
          <t>
            The Autonomous System Identifier Delegation Extension <xref target="RFC3779"/> MUST be present in the end-entity (EE) certificate (contained within the ASPA), and the Customer ASID in the ASPA eContent MUST be contained within the set of AS numbers specified by the EE certificate's Autonomous System Identifier Delegation Extension.
          </t>
          <t>
            The EE certificate's Autonomous System Identifier Delegation Extension MUST NOT contain any "inherit" elements.
          </t>
          <t>
            The IP Address Delegation Extension <xref target="RFC3779"/> MUST be absent.
          </t>
        </list>
      </t>
    </section>
    <section anchor="IANA" title="IANA Considerations">
      <section title="SMI Security for S/MIME Module Identifier registry">
        <t>
          Please add the id-mod-rpki-aspa-2022 to the SMI Security for S/MIME Module Identifier (1.2.840.113549.1.9.16.0) registry (https://www.iana.org/assignments/smi-numbers/smi-numbers.xml#security-smime-0) as follows:
        </t>
        <figure>
<artwork type="text">
    Decimal   | Description                   | Specification
    -----------------------------------------------------------
    TBD2      | id-mod-rpki-aspa-2022         | [RFC-to-be]
</artwork>
        </figure>
    </section>
    <section title="SMI Security for S/MIME CMS Content Type registry">
      <t>
        Please add the ASPA to the SMI Security for S/MIME CMS Content Type (1.2.840.113549.1.9.16.1) registry (https://www.iana.org/assignments/smi-numbers/smi-numbers.xml#security-smime-1) as follows:
      </t>
      <figure>
<artwork type="text">
    Decimal   | Description                   | Specification
    -----------------------------------------------------------
    49        | id-ct-ASPA                    | [RFC-to-be]
</artwork>
      </figure>
    </section>
    <section title="RPKI Signed Object registry">
      <t>
        Please add Autonomous System Provider Authorization to the RPKI Signed Object registry (https://www.iana.org/assignments/rpki/rpki.xhtml#signed-objects) as follows:
      </t>
      <figure>
<artwork type="text">
    Name                                     | OID                         | Specification
    --------------------------------------------------------------------------------------
    Autonomous System Provider Authorization | 1.2.840.113549.1.9.16.1.49  | [RFC-to-be]
</artwork>
      </figure>
    </section>
    <section title="RPKI Repository Name Scheme registry">
      <t>
        Please add an item for the Autonomous System Provider Authorization file extension to the "RPKI Repository Name Scheme" registry created by <xref target="RFC6481"/> as follows:
      </t>
      <figure>
        <artwork>
<![CDATA[
   Filename
   Extension  RPKI Object                               Reference
   --------------------------------------------------------------------------------------
      .asa    Autonomous System Provider Authorization  [RFC-to-be]
]]>
                </artwork>
      </figure>
    </section>
    <section title="Media Type registry">
      <t>
        The IANA is requested to register the media type application/rpki-aspa in the "Media Type" registry as follows:
      </t>
      <artwork>
<![CDATA[
   Type name: application
   Subtype name: rpki-aspa
   Required parameters: N/A
   Optional parameters: N/A
   Encoding considerations: binary
   Security considerations: Carries an RPKI ASPA [RFC-to-be].
       This media type contains no active content. See
       Section 4 of [RFC-to-be] for further information.
   Interoperability considerations: None
   Published specification: [RFC-to-be]
   Applications that use this media type: RPKI operators
   Additional information:
     Content: This media type is a signed object, as defined
         in [RFC6488], which contains a payload of a list of
         AS identifers as defined in [RFC-to-be].
     Magic number(s): None
     File extension(s): .asa
     Macintosh file type code(s):
   Person & email address to contact for further information:
     Job Snijders <job@fastly.com>
   Intended usage: COMMON
   Restrictions on usage: None
   Change controller: IETF
]]>
        </artwork>
      </section>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>
        The security considerations of <xref target="RFC6481"/>, <xref target="RFC6485"/>, and <xref target="RFC6488"/> also apply to ASPAs.
      </t>
    </section>

    <section removeInRFC="true">
      <name>Implementation status</name>
      <t>
        This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in RFC 7942.
        The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.
        Please note that the listing of any individual implementation here does not imply endorsement by the IETF.
        Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors.
        This is not intended as, and must not be construed to be, a catalog of available implementations or their features.
        Readers are advised to note that other implementations may exist.
      </t>
      <t>
        According to RFC 7942, "this will allow reviewers and working groups to assign due consideration to documents that have the benefit of running code, which may serve as evidence of valuable experimentation and feedback that have made the implemented protocols more mature.
        It is up to the individual working groups to use this information as they see fit".
      </t>
      <ul>
        <li>
          A validator implementation <xref target="rpki-client"/> (version 8.0 and higher), written in C was provided by Job Snijders from Fastly.
        </li>
        <li>
          A signer and decoder implementation <xref target="rpkimancer"/> written in Python was provided by Ben Maddison from Workonline.
        </li>
        <li>
          A signer implementation <xref target="krill"/> written in Rust was provided by Tim Bruijnzeels from NLnetLabs.
        </li>
        <li>
          At IETF114 Ties de Kock from RIPE NCC shared a signer implementation had been developed internally.
        </li>
        <li>
          Di Ma reported <xref target="rpstir2">success</xref> in RPSTIR2 validating objects produced by Tim Bruijnzeels.
        </li>
        <li>
          A signer <xref target="koenvh">implementation</xref> written in PHP based on OpenSSL was provided by Koen van Hove.
        </li>
        <li>
          A signer <xref target="aspa-demo">implementation</xref> written in Perl based on OpenSSL was provided by Tom Harrison from APNIC.
        </li>
      </ul>
    </section>

    <section anchor="Acknowledgments" title="Acknowledgments">
      <t>
        The authors would like to thank Keyur Patel for helping kick-start the ASPA profile project,
        Ties de Kock &amp; Tim Bruijnzeels for suggesting that the ProviderASSet be in a canonical form,
        and Claudio Jeker for review and several suggestions for improvements.
      </t>
    </section>
	
    <section title="Contributors" numbered="no">
      <t>
        The following people made significant contributions to this document:
      </t>

      <figure><artwork>
<![CDATA[
        Kotikalapudi Sriram
        USA National Institute of Standards and Technology
        Email: ksriram@nist.gov
]]>
      </artwork></figure>
    </section>

  </middle>

  <back>

    <references title="Normative References">

      <?rfc include="reference.RFC.2119.xml"?>
      <?rfc include="reference.RFC.3779.xml"?>
      <?rfc include="reference.RFC.5652.xml"?>
      <?rfc include="reference.RFC.6481.xml"?>
      <?rfc include="reference.RFC.6485.xml"?>
      <?rfc include="reference.RFC.6488.xml"?>
      <?rfc include="reference.RFC.8174.xml"?>

      <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-sidrops-aspa-verification.xml"/>
      <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-sidrops-8210bis.xml"/>

      <reference anchor="X.680">
        <front>
          <title>Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation</title>
          <author>
            <organization>ITU-T</organization>
          </author>
          <date year="2021"/>
        </front>
        <seriesInfo name="ITU-T" value="Recommendation X.680"/>
      </reference>

      <reference anchor="X.690">
        <front>
          <title>Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)</title>
          <author>
            <organization>ITU-T</organization>
          </author>
          <date year="2021"/>
        </front>
        <seriesInfo name="ITU-T" value="Recommendation X.690"/>
      </reference>

    </references>

    <references title="Informative References">

      <?rfc include="reference.RFC.4648.xml"?>
      <?rfc include="reference.RFC.6480.xml"?>
      <?rfc include="reference.RFC.7947.xml"?>

      <reference anchor="rpkimancer" target="https://github.com/benmaddison/rpkimancer-aspa">
        <front>
          <title>rpkimancer-aspa</title>
          <author initials="B." surname="Maddison">
            <organization>Workonline</organization>
          </author>
          <date year="2022"/>
        </front>
      </reference>

      <reference anchor="rpki-client" target="https://www.rpki-client.org/">
        <front>
          <title>rpki-client</title>
          <author initials="J." surname="Snijders">
            <organization>Fastly</organization>
          </author>
          <date year="2022"/>
        </front>
      </reference>

      <reference anchor="krill" target="https://github.com/NLnetLabs/krill">
        <front>
          <title>Krill</title>
          <author initials="T." surname="Bruijnzeels">
            <organization>NLnetLabs</organization>
          </author>
          <date year="2022"/>
        </front>
      </reference>

      <reference anchor="rpstir2" target="https://mailarchive.ietf.org/arch/msg/sidrops/pxqAGPmR0MA3NMe-NxYyiEZ7RXw">
        <front>
          <title>RPSTIR2</title>
          <author initials="D." surname="Ma">
            <organization>ZDNS</organization>
          </author>
          <date year="2022"/>
        </front>
      </reference>

      <reference anchor="aspa-demo" target="https://github.com/APNIC-net/rpki-aspa-demo">
        <front>
          <title>RPKI ASPA Demo</title>
          <author initials="T." surname="Harrison">
            <organization>APNIC</organization>
          </author>
          <date year="2022"/>
        </front>
      </reference>

      <reference anchor="koenvh" target="https://gitlab.com/Koenvh/relying-party-resiliency-platform/">
        <front>
          <title>Relying Party Resiliency Platform</title>
          <author initials="K." surname="van Hove">
            <organization>Independent</organization>
          </author>
          <date year="2022"/>
        </front>
      </reference>

      <reference anchor="IANA-AF" target="https://www.iana.org/assignments/address-family-numbers/address-family-numbers.xhtml">
        <front>
          <title>Address Family Numbers</title>
          <author>
            <organization>IANA</organization>
          </author>
          <date/>
        </front>
      </reference>

    </references>

    <section anchor="example">
      <name>Example ASPA eContent Payload</name>
      <t>
        Below an example of a DER encoded ASPA eContent is provided with annotation following the '#' character.
      </t>
      <artwork>
<![CDATA[
$ echo 302002023cca301a300402020b6230040202205b3005020300c7903005020303259e \
  | xxd -r -ps \
  | openssl asn1parse -inform DER -i -dump
    0:d=0  hl=2 l=  32 cons: SEQUENCE
    2:d=1  hl=2 l=   2 prim:  INTEGER      :3CCA    # Customer ASID 15562
    6:d=1  hl=2 l=  26 cons:  SEQUENCE              # ProviderASSet
    8:d=2  hl=2 l=   4 cons:   SEQUENCE             #  ProviderAS
   10:d=3  hl=2 l=   2 prim:    INTEGER     :0B62   #   ASID 2914
   14:d=2  hl=2 l=   4 cons:   SEQUENCE             #  ProviderAS
   16:d=3  hl=2 l=   2 prim:    INTEGER     :205B   #   ASID 8283
   20:d=2  hl=2 l=   5 cons:   SEQUENCE             #  ProviderAS
   22:d=3  hl=2 l=   3 prim:    INTEGER     :C790   #   ASID 51088
   27:d=2  hl=2 l=   5 cons:   SEQUENCE             #  ProviderAS
   29:d=3  hl=2 l=   3 prim:    INTEGER     :03259E #   ASID 206238
]]>
      </artwork>

      <t>
        Below is a complete <xref target="RFC4648">Base64</xref> encoded RPKI ASPA Signed Object.
      </t>
      <artwork>
<![CDATA[
MIIGpAYJKoZIhvcNAQcCoIIGlTCCBpECAQMxDTALBglghkgBZQMEAgEwMwYLKoZIhvcNAQkQ
ATGgJAQiMCACAjzKMBowBAICC2IwBAICIFswBQIDAMeQMAUCAwMlnqCCBJgwggSUMIIDfKAD
AgECAgoAocd1L/ix0uAdMA0GCSqGSIb3DQEBCwUAMDMxMTAvBgNVBAMTKGNhYTgwNWRiYWMz
NjQ3NDliOWIxMTU1OTBhYjZlZjBmOTcwY2RiZDgwHhcNMjIxMjE2MTIyOTU3WhcNMjMxMjE2
MTIyOTU3WjAVMRMwEQYDVQQDDAoxNjcxMTkzNTkxMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAsL/HdNkIhbYMis9xNfwvRYd3nqvlUQuzexfuX/HCLGIODNfbTqWaDeUcREyS
w+8cBP3gu1LwOjBSOdjDPFu9ceC1/EDHNXLhLG+CuOH/OePFFxwzdBb4yNKCFvoKd+F9JP57
55CDk8QusbJtWhRNL2lKHQevPAQpSqTkSF1SdFyzyBiEJE21CfOHBuDysLAj21c89gJst+lN
n2P9jBwaMqYibT2qbX9Chh3susjZk2M/etiIIxyRKBWLZT8V85KFghdf++mDc099ZP+JQnVn
q8SzZgkekn5pvsPWff5eB5ZvUe8Sn3XwfDSG4WgQP7Q0CX1l4X+g0fx7dEX7lmZbZwIDAQAB
o4IBxjCCAcIwDgYDVR0PAQH/BAQDAgeAMB0GA1UdDgQWBBQWNJ/mFfUaYaEoy70AbtZUiXyb
UzAfBgNVHSMEGDAWgBTKqAXbrDZHSbmxFVkKtu8Plwzb2DAYBgNVHSABAf8EDjAMMAoGCCsG
AQUFBw4CMBkGCCsGAQUFBwEIAQH/BAowCKAGMAQCAjzKMGQGCCsGAQUFBwEBBFgwVjBUBggr
BgEFBQcwAoZIcnN5bmM6Ly9ycGtpLnJpcGUubmV0L3JlcG9zaXRvcnkvREVGQVVMVC95cWdG
MjZ3MlIwbTVzUlZaQ3JidkQ1Y00yOWcuY2VyMGQGA1UdHwRdMFswWaBXoFWGU3JzeW5jOi8v
Y2hsb2Uuc29ib3Jub3N0Lm5ldC9ycGtpL1JJUEUtbmxqb2JzbmlqZGVycy95cWdGMjZ3MlIw
bTVzUlZaQ3JidkQ1Y00yOWcuY3JsMG8GCCsGAQUFBwELBGMwYTBfBggrBgEFBQcwC4ZTcnN5
bmM6Ly9jaGxvZS5zb2Jvcm5vc3QubmV0L3Jwa2kvUklQRS1ubGpvYnNuaWpkZXJzL0ZqU2Y1
aFgxR21HaEtNdTlBRzdXVklsOG0xTS5hc2EwDQYJKoZIhvcNAQELBQADggEBAHdOVNM2GrQc
TBQebdi2iKgC92XlGF9AlZcX4ZCQBL7gfQLfGEm6cIT73/Qo5PPsZ6kldQrPrERGeTntSEcV
LceFPihm54aAAbmQ0YQ3aZMdwvsbsLFMWBhbNiGwH6HdxyX63q94Did8IxE0HwOjJGfg02uN
xO9DseGSRGNzc9iZmLDFIn2wP1cmTKqntfxjNqc9T3zFWZT/m1BmXKylwpCIxxHbYYaOBnQi
xtJJ8HZlular3fwFQuVDuMxQ6Wg1jW3k6UBm06YwnyD3Nzck+4cIcGRnbQYDKBH/n3AyDGWr
UNnLSgFQzVV/Eu8rP2BXKHeLUCMw0/tB7f6vj+9LZS4xggGqMIIBpgIBA4AUFjSf5hX1GmGh
KMu9AG7WVIl8m1MwCwYJYIZIAWUDBAIBoGswGgYJKoZIhvcNAQkDMQ0GCyqGSIb3DQEJEAEx
MBwGCSqGSIb3DQEJBTEPFw0yMjEyMTYxMjMwMDJaMC8GCSqGSIb3DQEJBDEiBCDncgAuReFz
5lNB3nCNIY9N+TPcUjXeL3A8kGdpwI1JwTANBgkqhkiG9w0BAQEFAASCAQCaB43YGSkCOO/I
X26d9xC5vqGcZYNjAQe76VHDFJqa5x7RpthJC1cPe3fdKLazu6ywcuo6vvElT2OH0s/K0mCa
xFwfnZOn3cNUDJPtFYUynfQKyVGZjtyP8HLzxmgy2mSUzdcfEWVPSHc/u9CaIHdSNbeW7rBD
lWnf3j4MOVr5z4yf9BU2oBodpongR7dR1fvl7N/RymOdaLdqFYaj82plECZh9XqWqmHReBQG
c+EfXh7mw9aGQdFhBnprjRKd/oiBI1PVmystPv+XvunT8y8AxQ3XG1GL6Nca7OnfxNqGuyhs
0nbcbcd92GJwF3SBkdestmXZgxkl0HV7ZPH1xlvh
]]>
      </artwork>
    <t>
      The above should decode as following:
    </t>
    <artwork>
<![CDATA[
Object SHA256 hash:          wsCvp2J+eZeizU8nrXHkLPhcjyqZ5euDlwLssA/nlwg=
EE Subject key identifier:   16:34:9F:E6:15:F5:1A:61:A1:28:CB:BD:00:6E:D6:54:89:7C:9B:53
EE Certificate issuer:       /CN=caa805dbac364749b9b115590ab6ef0f970cdbd8
EE Certificate serial:       A1C7752FF8B1D2E01D
EE Authority key identifier: CA:A8:05:DB:AC:36:47:49:B9:B1:15:59:0A:B6:EF:0F:97:0C:DB:D8
EE Authority info access:    rsync://rpki.ripe.net/repository/DEFAULT/yqgF26w2R0m5sRVZCrbvD5cM29g.cer
EE Subject info access:      rsync://chloe.sobornost.net/rpki/RIPE-nljobsnijders/FjSf5hX1GmGhKMu9AG7WVIl8m1M.asa
EE NotAfter:                 Sat 16 Dec 2023 12:29:57 +0000
ASPA eContent:
  Customer AS:               15562
  Provider Set:              1: AS: 2914
                             2: AS: 8283
                             3: AS: 51088
                             4: AS: 206238
]]>
      </artwork>
    </section>

    <section anchor="transform">
      <name>Transforming ASPA eContent Payloads to RTR ASPA PDUs</name>
      <t>
        Below are a number of examples to demonstrate how one (or more) ASPA eContent Payloads are to be transformed into RTR ASPA PDUs.
        See section 5.12 of <xref target="I-D.ietf-sidrops-8210bis"/> for the specification of ASPA PDUs.
      </t>
      <t>
        Note that two PDUs are always generated per Customer ASID: one with AFI Flags = IPv4 and one with AFI Flags = IPv6.
      </t>

      <table>
        <thead>
          <tr>
            <th>Base64 DER-encoded eContent(s)</th>
            <th>RTR PDU (AFI flag = IPv4)</th>
            <th>RTR PDU (AFI flag = IPv6)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <artwork>
MCMGCyqGSIb3DQEJEAEx
oBQEEjAQAgMA/mMwCTAH
AgUA+lbqAQ==
</artwork>
            </td>
            <td>
              <t>Customer AS: 65123</t>
              <t>Provider AS Count: 1</t>
              <t>Provider ASes: 4200000001</t>
            </td>
            <td>
              <t>Customer AS: 65123</t>
              <t>Provider AS Count: 1</t>
              <t>Provider ASes: 4200000001</t>
            </td>
          </tr>
          <tr>
            <td>
              <artwork>
MCcGCyqGSIb3DQEJEAEx
oBgEFjAUAgMA/mMwDTAL
AgUA+lbqAQQCAAI=
</artwork>
            </td>
            <td>
              <t>Customer AS: 65123</t>
              <t>Provider AS Count: 1</t>
              <t>Provider ASes: 0</t>
            </td>
            <td>
              <t>Customer AS: 65123</t>
              <t>Provider AS Count: 1</t>
              <t>Provider ASes: 4200000001</t>
            </td>
          </tr>
          <tr>
            <td>
              <artwork>
MDQGCyqGSIb3DQEJEAEx
oCUEIzAhAgMA/mMwGjAL
AgUA+lbqAQQCAAEwCwIF
APpW6gIEAgAC
</artwork>
            </td>
            <td>
              <t>Customer AS: 65123</t>
              <t>Provider AS Count: 1</t>
              <t>Provider ASes: 4200000001</t>
            </td>
            <td>
              <t>Customer AS: 65123</t>
              <t>Provider AS Count: 1</t>
              <t>Provider ASes: 4200000002</t>
            </td>
          </tr>
          <tr>
            <td>
              <artwork>
MCMGCyqGSIb3DQEJEAEx
oBQEEjAQAgMA/mMwCTAH
AgUA+lbqAQ==

plus

MCcGCyqGSIb3DQEJEAEx
oBgEFjAUAgMA/mMwDTAL
AgUA+lbqAQQCAAI=
</artwork>
            </td>
            <td>
              <t>Customer AS: 65123</t>
              <t>Provider AS Count: 1</t>
              <t>Provider ASes: 4200000001</t>
            </td>
            <td>
              <t>Customer AS: 65123</t>
              <t>Provider AS Count: 1</t>
              <t>Provider ASes: 4200000001</t>
            </td>
          </tr>
          <tr>
            <td>
              <artwork>
MDAGCyqGSIb3DQEJEAEx
oCEEHzAdAgMA/mMwFjAH
AgUA+lbqATALAgUA+lbq
AgQCAAI=
</artwork>
            </td>
            <td>
              <t>Customer AS: 65123</t>
              <t>Provider AS Count: 1</t>
              <t>Provider ASes: 4200000001</t>
            </td>
            <td>
              <t>Customer AS: 65123</t>
              <t>Provider AS Count: 2</t>
              <t>Provider ASes: 4200000001, 4200000002</t>
            </td>
          </tr>
        </tbody>
      </table>

    </section>

  </back>
</rfc>
